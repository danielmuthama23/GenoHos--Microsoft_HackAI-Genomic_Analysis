{"name":"Power BI Dataset","ppdf:dataflowId":"28a2e0b5-f4aa-4f7f-9953-70794b6d1ffd","ppdf:owner":{"tenantId":"e667c7e4-c17c-4a7f-9b6f-d56df4d75cc8","userId":"7c38aabf-71be-44a2-8bd1-240d7015d15e"},"ppdf:fastCopy":true,"version":"1.0","culture":"en-GB","modifiedTime":"2025-04-03T18:33:25.137076+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"Power BI dataflows (Legacy)":{"queryId":"e1318355-306f-46ae-9eec-53b3eed143e6","queryName":"Power BI dataflows (Legacy)"},"Power BI dataflows (Legacy)_DataDestination":{"queryId":"3723d04a-d532-423c-ad3c-38f656fc7e5c","queryName":"Power BI dataflows (Legacy)_DataDestination"},"DefaultDestination":{"queryId":"0c24ee3a-170c-4a38-a7da-1e4219c88668","queryName":"DefaultDestination"},"Power BI dataflows (Legacy)_WriteToDataDestination":{"queryId":"31bbb55e-0359-419e-9aa4-56c336ba3f7b","queryName":"Power BI dataflows (Legacy)_WriteToDataDestination"},"Power BI dataflows (Legacy)_TransformForWriteToDataDestination":{"queryId":"31415fce-a1e7-4ce5-92b6-cc38cb123045","queryName":"Power BI dataflows (Legacy)_TransformForWriteToDataDestination"},"FastCopyStaging":{"queryId":"78aa5830-2653-4a71-8cf4-aa7687be2f6f","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared #\"Power BI dataflows (Legacy)\" = let\r\n  Source = PowerBI.Dataflows([]),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(Source, {{\"workspaceId\", Int64.Type}, {\"Data\", Int64.Type}, {\"workspaceType\", type text}, {\"workspaceName\", type text}, {\"ItemName\", type text}})\r\nin\r\n  #\"Changed column type\";\r\nshared #\"Power BI dataflows (Legacy)_DataDestination\" = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"cde60769-1208-4712-9d88-602cb5dae476\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"10f68d8b-f1eb-41b0-b515-e0974aec5206\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"gold_patient_demographics\", ItemKind = \"Table\"]}[Data]\r\nin\r\n  TableNavigation;\r\nshared DefaultDestination = let\r\n  Source = Lakehouse.Contents([CreateNavigationProperties = false]),\r\n  #\"Navigation 1\" = Source{[workspaceId = \"cde60769-1208-4712-9d88-602cb5dae476\"]}[Data],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[lakehouseId = \"10f68d8b-f1eb-41b0-b515-e0974aec5206\"]}[Data]\r\nin\r\n  #\"Navigation 2\";\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\n[Staging = \"FastCopyStaging\"]\r\nshared #\"Power BI dataflows (Legacy)_WriteToDataDestination\" = let\r\n  #\"Power BI dataflows (Legacy)_WriteToDataDestination\" = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = #\"Power BI dataflows (Legacy)_DataDestination\"], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], #\"Power BI dataflows (Legacy)_TransformForWriteToDataDestination\"), Action.DoNothing}))\r\nin\r\n  #\"Power BI dataflows (Legacy)_WriteToDataDestination\";\r\nshared #\"Power BI dataflows (Legacy)_TransformForWriteToDataDestination\" = let\r\n    ColumnMappings = {[SourceColumnName = \"workspaceType\", DestinationColumnName = \"patient_hash\"], [SourceColumnName = \"Data\", DestinationColumnName = \"age\"]},\r\n    SourceColumns = Table.SelectColumns(#\"Power BI dataflows (Legacy)\", List.Transform(ColumnMappings, each _[SourceColumnName])),\r\n    TargetColumns = Table.RenameColumns(SourceColumns, List.Transform(ColumnMappings, each {_[SourceColumnName], _[DestinationColumnName]}))\r\nin\r\n    TargetColumns;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"PowerBI","kind":"PowerBI","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"PowerBI\",\"path\":\"PowerBI\"}","audience":null},{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]}}